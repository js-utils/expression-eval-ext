{"version":3,"file":"expression-eval-ext.modern.js","sources":["../src/lib/ASTHelper.js"],"sourcesContent":["class ASTHelper {\n\tconstructor (ast) {\n\t\tthis.ast = ast\n\t}\n\tget ast () { return this._ast }\n\tset ast (val) {\n\t\tthis._ast = val\n\t\tthis.reCompute()\n\t}\n\n\treCompute () {\n\t\tthis.astSplitArray = this.toArray(this.ast)\n\t\tthis.expressionSplitArray = []\n\t\tthis.expression = this.toExpression(this.astSplitArray, true)\n\t}\n\ttoArray (ast) {\n\t\tconst tags = []\n\t\tlet layer = ast\n\t\t// console.log('layer', layer)\n\t\twhile(layer) {\n\t\t\tswitch(layer.type) {\n\t\t\t\tcase 'MemberExpression':\n\t\t\t\t\ttags.push({operator: '.', left: '', right: layer.property.name, type: layer.type })\n\t\t\t\t\tlayer = layer.object\n\t\t\t\t\tbreak\n\t\t\t\tcase 'CallExpression':\n\t\t\t\t\t// tags.push(this.ViewModel.find(layer.arguments[0].value).name)\n\t\t\t\t\ttags.push({ operator: '.', left: '', right: `${ layer.callee.property.name }(${layer.arguments.map(arg => {\n\t\t\t\t\t\t\tif (typeof arg.value === 'string') {\n\t\t\t\t\t\t\t\treturn `'${arg.value}'`\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn arg.value\n\t\t\t\t\t\t}).join(',')})`, type: layer.type })\n\t\t\t\t\tlayer = layer.callee.object\n\t\t\t\t\tbreak\n\t\t\t\tcase 'Identifier':\n\t\t\t\t\ttags.push({ operator: '', left: '', right: layer.name, type: layer.type })\n\t\t\t\t\tlayer = layer.object\n\t\t\t\t\tbreak\n\t\t\t\tcase 'BinaryExpression':\n\t\t\t\t\ttags.push({ operator: layer.operator, left: this.toArray(layer.left), right: this.toArray(layer.right), type: layer.type })\n\t\t\t\t\tlayer = layer.object\n\t\t\t\t\tbreak\n\t\t\t\tcase 'Literal':\n\t\t\t\t\ttags.push({\n\t\t\t\t\t\toperator: '',\n\t\t\t\t\t\tleft: '',\n\t\t\t\t\t\tright: typeof layer.value === 'string' ? `'${ layer.value }'` : layer.value,\n\t\t\t\t\t\ttype: layer.type\n\t\t\t\t\t})\n\t\t\t\t\tlayer = layer.object\n\t\t\t\t\tbreak\n\t\t\t\tdefault:\n\t\t\t\t\tlayer = null\n\t\t\t}\n\t\t}\n\t\treturn tags.reverse()\n\t}\n\ttoExpression (astSplitArray, entry) {\n\t\tlet expression = ''\n\t\t// console.log('astSplitArray', astSplitArray)\n\t\tfor(const cLayer of astSplitArray) {\n\t\t\tif (cLayer.type === 'BinaryExpression') {\n\t\t\t\tconst leftExpression = this.toExpression(cLayer.left)\n\t\t\t\tconst rightExpression =  this.toExpression(cLayer.right)\n\t\t\t\texpression = `${leftExpression}${cLayer.operator}${rightExpression}`\n\t\t\t\tthis.expressionSplitArray.push(leftExpression, cLayer.operator, rightExpression)\n\t\t\t\tif (!entry) {\n\t\t\t\t\texpression = `(${expression})`\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\texpression = `${expression}${ cLayer.left }${ cLayer.operator }${ cLayer.right }`\n\t\t\t}\n\t\t}\n\t\treturn expression\n\t}\n}\nexport default ASTHelper\n"],"names":["ASTHelper","constructor","ast","this","_ast","val","reCompute","astSplitArray","toArray","expressionSplitArray","expression","toExpression","tags","layer","type","push","operator","left","right","property","name","object","callee","arguments","map","arg","value","join","reverse","entry","cLayer","leftExpression","rightExpression"],"mappings":"2HAAA,MAAMA,EACLC,YAAaC,GACZC,KAAKD,IAAMA,EAEZA,UAAa,YAAYE,KACzBF,QAASG,GACRF,KAAKC,KAAOC,EACZF,KAAKG,YAGNA,YACCH,KAAKI,cAAgBJ,KAAKK,QAAQL,KAAKD,KACvCC,KAAKM,qBAAuB,GAC5BN,KAAKO,WAAaP,KAAKQ,aAAaR,KAAKI,eAAe,GAEzDC,QAASN,GACR,MAAMU,EAAO,GACb,IAAIC,EAAQX,EAEZ,KAAMW,GACL,OAAOA,EAAMC,MACZ,IAAK,mBACJF,EAAKG,KAAK,CAACC,SAAU,IAAKC,KAAM,GAAIC,MAAOL,EAAMM,SAASC,KAAMN,KAAMD,EAAMC,OAC5ED,EAAQA,EAAMQ,OACd,MACD,IAAK,iBAEJT,EAAKG,KAAK,CAAEC,SAAU,IAAKC,KAAM,GAAIC,MAAQ,GAAGL,EAAMS,OAAOH,SAASC,QAASP,EAAMU,UAAUC,IAAIC,GACxE,iBAAdA,EAAIC,MACN,IAAGD,EAAIC,SAETD,EAAIC,OACTC,KAAK,QAASb,KAAMD,EAAMC,OAC9BD,EAAQA,EAAMS,OAAOD,OACrB,MACD,IAAK,aACJT,EAAKG,KAAK,CAAEC,SAAU,GAAIC,KAAM,GAAIC,MAAOL,EAAMO,KAAMN,KAAMD,EAAMC,OACnED,EAAQA,EAAMQ,OACd,MACD,IAAK,mBACJT,EAAKG,KAAK,CAAEC,SAAUH,EAAMG,SAAUC,KAAMd,KAAKK,QAAQK,EAAMI,MAAOC,MAAOf,KAAKK,QAAQK,EAAMK,OAAQJ,KAAMD,EAAMC,OACpHD,EAAQA,EAAMQ,OACd,MACD,IAAK,UACJT,EAAKG,KAAK,CACTC,SAAU,GACVC,KAAM,GACNC,MAA8B,iBAAhBL,EAAMa,MAAsB,IAAIb,EAAMa,SAAYb,EAAMa,MACtEZ,KAAMD,EAAMC,OAEbD,EAAQA,EAAMQ,OACd,MACD,QACCR,EAAQ,KAGX,OAAOD,EAAKgB,UAEbjB,aAAcJ,EAAesB,GAC5B,IAAInB,EAAa,GAEjB,IAAI,MAAMoB,KAAUvB,EACnB,GAAoB,qBAAhBuB,EAAOhB,KAA6B,CACvC,MAAMiB,EAAiB5B,KAAKQ,aAAamB,EAAOb,MAC1Ce,EAAmB7B,KAAKQ,aAAamB,EAAOZ,OAClDR,EAAc,GAAEqB,IAAiBD,EAAOd,WAAWgB,IACnD7B,KAAKM,qBAAqBM,KAAKgB,EAAgBD,EAAOd,SAAUgB,GAC3DH,IACJnB,EAAc,IAAGA,WAGlBA,EAAc,GAAEA,IAAcoB,EAAOb,OAASa,EAAOd,WAAac,EAAOZ,QAG3E,OAAOR"}